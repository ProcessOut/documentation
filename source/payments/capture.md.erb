## Capturing a payment and getting paid

Previous to capturing a payment, you must first have generated or stored a token
using [`ProcessOut.js` &nearr;](#) and send it back to the server. This guide
aims at making use of this token to capture a payment.

<hr>

#### Generating an invoice

Prior to getting paid, you first need to create an [`Invoice` &nearr;](#) resource
meant to define how much your customer will get charged, and set metadata
related to the payment.

```sh
curl https://api.processout.com/invoices \
    -u projectID:projectSecret \
    -d name="Awesome invoice" \
    -d amount=9.99 \
    -d currency=USD 
```


#### Capturing the invoice

Now that we have an invoice, we can capture it using the token previously
generated by [`ProcessOut.js` &nearr;](#).

```sh
curl https://api.processout.com/invoices/iv_lEZFFcQg5WwpKcolBrlzioeeFnnuPmyE/capture \
    -d source=card_Tpu6ZOCDu1tnDKp0kTnPOcVDMUbW7dTU
```

If the capture was successful, a transaction is returned. You may then check that
its `captured` attribute is set to `true` in order to confirm the payment.


#### Authorizing to only capture later

It is also possible to only authorize a payment and capture it later (7 days
max). This is done using the authorization & capture flow. Let's first
authorize the payment:

```sh
curl https://api.processout.com/invoices/iv_lEZFFcQg5WwpKcolBrlzioeeFnnuPmyE/authorize \
    -d source=card_Tpu6ZOCDu1tnDKp0kTnPOcVDMUbW7dTU 
```

If the authorization was successful, a transaction is returned. You may also
check its `authorized` field is set to `true` to confirm the authorization.
Now that the payment was authorized, you can save the ID of the `Invoice` you
generated earlier, and capture it a later time (the token isn't needed when
an authorization has already been done):

```sh
curl https://api.processout.com/invoices/iv_lEZFFcQg5WwpKcolBrlzioeeFnnuPmyE/capture \
    -X POST
```

If the capture was successful, the same transaction as the one returned when doing
the authorization should be returned. You may check that its `captured` attribute
is now set to `true` to confirm the payment.